<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capacity Planning - Software Estimation Manager</title>
    <link rel="stylesheet" href="styles/capacity.css">
</head>
<body>
    <!-- Capacity Planning Section -->
    <section id="capacity-section" class="main-section">

        <!-- Statistics and Alerts Panel -->
        <div class="stats-panel">
            <div class="panel-header">
                <h2>üìä Resource Capacity Overview</h2>
                <div class="overview-filters">
                    <div class="filter-group">
                        <label for="overview-member-filter">Member:</label>
                        <select id="overview-member-filter" class="filter-select">
                            <option value="">All Members</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="overview-status-filter">Status View:</label>
                        <select id="overview-status-filter" class="filter-select">
                            <option value="all">All Status (Forecast)</option>
                            <option value="approved">Approved Only</option>
                            <option value="pending">Pending Only</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="capacity-overview-grid" id="capacity-overview-grid">
                <!-- Dynamic capacity overview will be generated here -->
            </div>
        </div>

        <!-- Capacity Planning Table -->
        <div class="capacity-table-container">
            <div class="capacity-table-header">
                <h2>üìä Capacity Planning Timeline</h2>
                <div class="table-actions">
                    <button id="add-assignment-btn" class="btn-primary">
                        ‚ûï Add Assignment
                    </button>
                    <button id="export-table-btn" class="btn-secondary">
                        üìä Export Table
                    </button>
                </div>
            </div>
            
            <!-- Table Filters -->
            <div class="capacity-filters">
                <div class="filter-group">
                    <label for="team-filter">Team:</label>
                    <select id="team-filter" class="filter-select">
                        <option value="">All Teams</option>
                        <option value="vendor-a">Vendor A</option>
                        <option value="internal">Internal Resources</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="projects-filter">Projects:</label>
                    <select id="projects-filter" class="filter-select">
                        <option value="">All Projects</option>
                        <option value="customer-portal">Customer Portal</option>
                        <option value="mobile-app">Mobile App</option>
                        <option value="api-gateway">API Gateway</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="timeline-range">Timeline:</label>
                    <select id="timeline-range" class="filter-select">
                        <option value="15">15 months</option>
                        <option value="12">12 months</option>
                        <option value="6">6 months</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="status-filter">Status:</label>
                    <select id="status-filter" class="filter-select">
                        <option value="all">All Statuses</option>
                        <option value="approved">Approved</option>
                        <option value="pending">Pending</option>
                        <option value="draft">Draft</option>
                    </select>
                </div>
            </div>
            
            <div class="scrollable-table-wrapper">
                <table id="capacity-table" class="capacity-planning-table">
                    <thead>
                        <tr>
                            <!-- Fixed columns -->
                            <th class="fixed-col col-member">Team Member</th>
                            <th class="fixed-col col-project">Project</th>
                            <th class="fixed-col col-status">Status</th>
                            <!-- Scrollable month columns - All current year months + 3 next year months -->
                            <th class="month-col" data-month="2024-01">Jan 24</th>
                            <th class="month-col" data-month="2024-02">Feb 24</th>
                            <th class="month-col" data-month="2024-03">Mar 24</th>
                            <th class="month-col" data-month="2024-04">Apr 24</th>
                            <th class="month-col" data-month="2024-05">May 24</th>
                            <th class="month-col" data-month="2024-06">Jun 24</th>
                            <th class="month-col" data-month="2024-07">Jul 24</th>
                            <th class="month-col" data-month="2024-08">Aug 24</th>
                            <th class="month-col" data-month="2024-09">Sep 24</th>
                            <th class="month-col" data-month="2024-10">Oct 24</th>
                            <th class="month-col" data-month="2024-11">Nov 24</th>
                            <th class="month-col" data-month="2024-12">Dec 24</th>
                            <th class="month-col" data-month="2025-01">Jan 25</th>
                            <th class="month-col" data-month="2025-02">Feb 25</th>
                            <th class="month-col" data-month="2025-03">Mar 25</th>
                        </tr>
                    </thead>
                    <tbody id="capacity-table-body">
                        <!-- Table rows will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>

    </section>

    <!-- Modals -->
    
    <!-- Add/Edit Team Member Modal -->
    <div id="team-member-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="team-member-modal-title">Add Team Member</h2>
                <button class="modal-close" onclick="closeTeamMemberModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="team-member-form">
                    <div class="form-group">
                        <label for="tm-first-name">First Name:</label>
                        <input type="text" id="tm-first-name" name="firstName" required>
                    </div>
                    <div class="form-group">
                        <label for="tm-last-name">Last Name:</label>
                        <input type="text" id="tm-last-name" name="lastName" required>
                    </div>
                    <div class="form-group">
                        <label for="tm-vendor">Vendor:</label>
                        <select id="tm-vendor" name="vendor" required>
                            <option value="">Select vendor...</option>
                            <option value="vendor-a">Vendor A</option>
                            <option value="internal">Internal Resources</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="tm-role">Role:</label>
                        <select id="tm-role" name="role">
                            <option value="G2">G2</option>
                            <option value="G1">G1</option>
                            <option value="PM">PM</option>
                            <option value="TA">TA</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="tm-capacity">Monthly Capacity (working days):</label>
                        <input type="number" id="tm-capacity" name="monthlyCapacity" value="22" min="1" max="31">
                    </div>
                    
                    <div class="vacation-planning-section">
                        <h3>üèñÔ∏è Vacation Planning</h3>
                        <div class="vacation-years">
                            <div class="vacation-year">
                                <label>2024: <input type="number" id="tm-vacation-2024" min="0" max="50" value="25"> days</label>
                                <button type="button" class="btn-secondary" onclick="editVacationCalendar(2024)">üìÖ Edit Calendar</button>
                            </div>
                            <div class="vacation-year">
                                <label>2025: <input type="number" id="tm-vacation-2025" min="0" max="50" value="25"> days</label>
                                <button type="button" class="btn-secondary" onclick="editVacationCalendar(2025)">üìÖ Edit Calendar</button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeTeamMemberModal()">Cancel</button>
                <button type="submit" class="btn-primary" onclick="saveTeamMember()">Save Member</button>
            </div>
        </div>
    </div>

    <!-- Project Assignment Modal -->
    <div id="assignment-modal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h2 id="assignment-modal-title">New Project Assignment</h2>
                <button class="modal-close" onclick="closeAssignmentModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="assignment-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pa-project">Project:</label>
                            <select id="pa-project" name="projectId" required>
                                <option value="">Select project...</option>
                                <option value="customer-portal">Customer Portal Project</option>
                                <option value="mobile-app">Mobile App Enhancement</option>
                                <option value="api-gateway">API Gateway Development</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="pa-team-member">Team Member:</label>
                            <select id="pa-team-member" name="teamMemberId" required>
                                <option value="">Select team member...</option>
                                <option value="tm-001">Mario Rossi (G2 - Vendor A)</option>
                                <option value="tm-002">Anna Bianchi (PM - Internal)</option>
                                <option value="tm-003">Luca Verdi (G1 - Vendor A)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pa-start-date">Start Date:</label>
                            <input type="date" id="pa-start-date" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="pa-end-date">End Date (auto-calculated):</label>
                            <input type="date" id="pa-end-date" name="endDate" readonly>
                        </div>
                        <div class="form-group">
                            <label for="pa-status">Status:</label>
                            <select id="pa-status" name="status">
                                <option value="pending">Pending</option>
                                <option value="approved">Approved</option>
                            </select>
                        </div>
                    </div>

                    <div class="project-calculation-section">
                        <h3>üìä Project Calculation Data</h3>
                        <div class="calculation-info">
                            <div class="calc-item">
                                <label>Total MDs from calculations:</label>
                                <span id="pa-total-mds" class="calc-value">120</span>
                            </div>
                            <div class="calc-breakdown">
                                <span>Development: 80 MDs</span>
                                <span>UAT: 25 MDs</span>
                                <span>Other: 15 MDs</span>
                            </div>
                        </div>
                    </div>

                    <div class="monthly-allocation-section">
                        <h3>üìÖ Monthly Allocation (Auto-Distributed)</h3>
                        <div class="allocation-grid">
                            <div class="allocation-month">
                                <label>Feb 2024:</label>
                                <input type="number" class="allocation-input" value="20" min="0">
                                <span class="capacity-indicator available">‚úÖ</span>
                            </div>
                            <div class="allocation-month">
                                <label>Mar 2024:</label>
                                <input type="number" class="allocation-input" value="22" min="0">
                                <span class="capacity-indicator available">‚úÖ</span>
                            </div>
                            <div class="allocation-month">
                                <label>Apr 2024:</label>
                                <input type="number" class="allocation-input" value="18" min="0">
                                <span class="capacity-indicator available">‚úÖ</span>
                            </div>
                            <div class="allocation-month">
                                <label>May 2024:</label>
                                <input type="number" class="allocation-input overflow" value="25" min="0">
                                <span class="capacity-indicator overflow">‚ö†Ô∏è</span>
                            </div>
                            <div class="allocation-month">
                                <label>Jun 2024:</label>
                                <input type="number" class="allocation-input" value="22" min="0">
                                <span class="capacity-indicator available">‚úÖ</span>
                            </div>
                            <div class="allocation-month">
                                <label>Jul 2024:</label>
                                <input type="number" class="allocation-input" value="13" min="0">
                                <span class="capacity-indicator vacation">üèñÔ∏è</span>
                            </div>
                        </div>
                        <div class="auto-redistribute-section">
                            <button type="button" class="btn-secondary" onclick="autoRedistribute()">üîÑ Auto-Redistribute</button>
                            <span class="redistribute-info">Automatically redistribute MDs to avoid overflow</span>
                        </div>
                    </div>

                    <div class="overflow-alerts-section" id="assignment-overflow-alerts">
                        <h3>‚ö†Ô∏è Overflow Alerts</h3>
                        <div class="alert-item overflow">
                            <span class="alert-icon">‚ö†Ô∏è</span>
                            <span class="alert-text">May 2024: Capacity exceeded by 3 MDs</span>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeAssignmentModal()">Cancel</button>
                <button type="submit" class="btn-primary" onclick="saveAssignment()">Save Assignment</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // Mock functions for demonstration
        function editTeamMember(id) {
            console.log('Edit team member:', id);
            document.getElementById('team-member-modal').style.display = 'block';
        }

        function viewMemberDetails(id) {
            console.log('View member details:', id);
        }

        function closeTeamMemberModal() {
            document.getElementById('team-member-modal').style.display = 'none';
        }

        function editAssignment(id) {
            console.log('Edit assignment:', id);
            document.getElementById('assignment-modal').style.display = 'block';
        }

        function viewAssignmentDetails(id) {
            console.log('View assignment details:', id);
        }

        function approveAssignment(id) {
            console.log('Approve assignment:', id);
        }

        function closeAssignmentModal() {
            document.getElementById('assignment-modal').style.display = 'none';
        }

        function resolveOverflow(memberId, month) {
            console.log('Resolve overflow for:', memberId, month);
        }

        function viewCapacity(memberId, month) {
            console.log('View capacity for:', memberId, month);
        }

        function editCalendar(memberId) {
            console.log('Edit calendar for:', memberId);
        }

        function adjustCapacity(memberId) {
            console.log('Adjust capacity for:', memberId);
        }

        function editVacationCalendar(year) {
            console.log('Edit vacation calendar for:', year);
        }

        function saveTeamMember() {
            console.log('Save team member');
            closeTeamMemberModal();
        }

        function autoRedistribute() {
            console.log('Auto-redistribute allocations');
        }

        function saveAssignment() {
            console.log('Save assignment');
            closeAssignmentModal();
        }

        // Initialize capacity section
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Capacity section loaded with mock data');
        });
    </script>
</body>
</html>